# 🔌 Dual MPU6050 Sensor Wiring Guide

2개의 MPU6050 센서를 사용한 고정밀 자세 추적 시스템 연결 가이드입니다.

## 🎯 시스템 개요

### 센서 배치 전략
- **센서 1 (Upper)**: 상부 흉추/목 부분 (T1-T3) - 머리와 목의 움직임 추적
- **센서 2 (Mid)**: 중부 흉추 부분 (T7-T9) - 척추 중심부 움직임 추적

### 측정 가능한 자세 문제
✅ **Forward Head Posture** (거북목) - 두 센서 간 각도 차이로 정밀 측정  
✅ **Hunched Shoulders** (굽은 어깨) - 상부 센서의 과도한 전방 기울임  
✅ **Spine Curvature** (척추 곡률) - 센서 간 상대적 각도 변화  
✅ **Side Lean** (측면 기울임) - 좌우 불균형 감지  
✅ **Dynamic Movement** (동적 움직임) - 실시간 자세 변화 추적

## 🔧 하드웨어 요구사항

### 필수 부품
- **ESP32 개발보드** (1개)
- **MPU6050 센서 모듈** (2개) - 6DOF IMU
- **브레드보드** (400 tie-points) 또는 **PCB 프로토타입 보드**
- **점퍼 와이어** (Male-to-Male, 8개 이상)
- **점퍼 와이어** (Female-to-Female, 센서 연결용)
- **저항** (10kΩ, 2개) - I2C 풀업용 (선택사항)

### 센서 모듈 확인
각 MPU6050 모듈에서 확인할 핀:
```
MPU6050 Module Pins:
VCC  - 전원 (3.3V)
GND  - 그라운드  
SDA  - I2C 데이터
SCL  - I2C 클럭
AD0  - 주소 선택 (중요!)
INT  - 인터럽트 (사용안함)
```

## 📡 I2C 주소 설정

### 주소 구성
- **센서 1**: `0x68` (기본 주소) - AD0 핀을 **GND** 또는 **연결안함**
- **센서 2**: `0x69` (대체 주소) - AD0 핀을 **3.3V**에 연결

### AD0 핀 연결 방법
```
Sensor 1 (Upper Spine):
AD0 pin → GND (또는 연결 안함)
→ I2C Address: 0x68

Sensor 2 (Mid Spine):  
AD0 pin → 3.3V
→ I2C Address: 0x69
```

## 🔌 상세 연결도

### ESP32 ↔ 듀얼 MPU6050 연결
```
ESP32 Pin    →    Sensor 1 (0x68)    →    Sensor 2 (0x69)    →    Function
────────────────────────────────────────────────────────────────────────────
3.3V         →    VCC                →    VCC                →    Power Supply
GND          →    GND                →    GND                →    Ground
GPIO21       →    SDA                →    SDA                →    I2C Data
GPIO22       →    SCL                →    SCL                →    I2C Clock
GND          →    AD0                →    (not connected)    →    Address 0x68
3.3V         →    (not connected)    →    AD0                →    Address 0x69
```

### 브레드보드 연결도
```
                ESP32                         Sensor 1           Sensor 2
              ┌─────────┐                    ┌─────────┐        ┌─────────┐
              │    3.3V ├────────────────────┤VCC      │ ───────┤VCC      │
              │     GND ├──────────┬─────────┤GND      │ ───────┤GND      │
              │  GPIO21 ├──────────┼─────────┤SDA      │ ───────┤SDA      │
              │  GPIO22 ├──────────┼─────────┤SCL      │ ───────┤SCL      │
              │     GND ├──────────┴─────────┤AD0      │        │         │
              │    3.3V ├────────────────────┼─────────────────┤AD0      │
              └─────────┘                    └─────────┘        └─────────┘
                                                 (0x68)            (0x69)
```

## ⚙️ 단계별 조립 가이드

### Step 1: 센서 주소 설정
1. **센서 1 준비**:
   - AD0 핀을 GND에 연결 (또는 연결 안함)
   - 라벨 부착: "Upper Spine (0x68)"

2. **센서 2 준비**:
   - AD0 핀을 3.3V에 연결 (작은 점퍼 와이어 사용)
   - 라벨 부착: "Mid Spine (0x69)"

### Step 2: 전원 연결
1. **ESP32 3.3V** → **브레드보드 파워 레일**
2. **ESP32 GND** → **브레드보드 그라운드 레일**
3. **두 센서의 VCC** → **파워 레일**
4. **두 센서의 GND** → **그라운드 레일**

### Step 3: I2C 버스 연결
1. **ESP32 GPIO21 (SDA)** → **브레드보드 SDA 라인**
2. **ESP32 GPIO22 (SCL)** → **브레드보드 SCL 라인**
3. **두 센서의 SDA** → **SDA 라인**
4. **두 센서의 SCL** → **SCL 라인**

### Step 4: I2C 풀업 저항 (선택사항)
긴 와이어 사용 시 신호 안정화를 위해:
```
10kΩ 저항: 3.3V ─┬─ SDA 라인
10kΩ 저항: 3.3V ─┴─ SCL 라인
```

## 🧪 연결 검증

### 전원 테스트
```bash
# 멀티미터로 확인:
Sensor 1 VCC: 3.3V (±0.1V)
Sensor 2 VCC: 3.3V (±0.1V)
Sensor 1 AD0: 0V (GND)
Sensor 2 AD0: 3.3V
```

### I2C 스캔 테스트
```cpp
// Arduino IDE에서 I2C Scanner 실행
// 예상 결과:
I2C device found at address 0x68 !  // Sensor 1
I2C device found at address 0x69 !  // Sensor 2
done
```

### 듀얼 센서 업로드 테스트
1. `dual_mpu6050_tracker.ino` 업로드
2. Serial Monitor (115200 baud) 확인
3. 예상 출력:
```
Smart Posture Tracker - Dual MPU6050 System
===========================================
MPU6050 Sensor 1 (0x68) Found!
MPU6050 Sensor 2 (0x69) Found!
Sensor 1 - Accelerometer range: ±8G
Sensor 2 - Accelerometer range: ±8G
Calibrating............ Done!

CSV Header: timestamp,s1_ax,s1_ay,s1_az,s1_gx,s1_gy,s1_gz,s1_temp,s2_ax,s2_ay,s2_az,s2_gx,s2_gy,s2_gz,s2_temp
1000,0.123,0.456,9.789,0.001,0.002,0.003,25.67,0.134,0.467,9.798,0.002,0.001,0.004,25.69
```

## 🐛 문제 해결

### ❌ "Failed to find sensor at 0x69"
**원인**: 센서 2의 AD0 핀이 3.3V에 연결되지 않음
**해결**:
1. AD0 핀이 3.3V에 확실히 연결되었는지 확인
2. 점퍼 와이어 접촉 불량 점검
3. I2C Scanner로 주소 확인

### ❌ "Both sensors show same address"
**원인**: 두 센서 모두 기본 주소 0x68 사용
**해결**:
1. 센서 2의 AD0 핀을 GND에서 분리
2. AD0 핀을 3.3V에 연결
3. ESP32 리셋 후 다시 테스트

### ❌ 센서 데이터가 불안정함
**원인**: 전원 공급 부족 또는 I2C 신호 간섭
**해결**:
1. USB 케이블을 더 두꺼운 것으로 교체
2. 브레드보드 연결 다시 확인
3. I2C 풀업 저항 추가 (10kΩ)
4. 센서 간 거리 확보 (전자기 간섭 방지)

### ❌ 캘리브레이션 중 에러
**원인**: 센서가 움직이거나 진동 발생
**해결**:
1. 캘리브레이션 중 센서를 완전히 고정
2. 안정된 표면에 놓기
3. 진동이 없는 환경에서 테스트

## 📊 센서 배치 권장사항

### 실제 착용 시 센서 위치
```
목/상부 흉추 센서 (Sensor 1):
┌─────────────┐
│    목 뒤쪽    │ ← 7번째 경추 (C7) 근처
│   Sensor 1   │   목과 어깨 경계 부분
│  (Upper)     │
└─────────────┘

중부 흉추 센서 (Sensor 2):
     │
     ▼
┌─────────────┐
│  어깨뼈 사이   │ ← 7-9번째 흉추 (T7-T9)
│   Sensor 2   │   날개뼈 중간 높이
│   (Mid)      │
└─────────────┘
```

### 센서 고정 방법
1. **개발/테스트 단계**: 브레드보드에 고정 후 테이프로 임시 부착
2. **프로토타입 단계**: 3D 프린팅 케이스 또는 PCB 제작
3. **최종 제품**: 텍스타일 통합 (스마트 의류)

## ⚡ 전력 최적화

### 배터리 사용 시 고려사항
- **소비전력**: ~200mA (두 센서 + ESP32)
- **권장 배터리**: 3.7V Li-Po 2000mAh 이상
- **예상 사용시간**: 10-12시간 연속 동작
- **저전력 모드**: 향후 구현 예정 (sleep mode)

## 🔄 다음 단계

연결 완료 후:
1. ✅ **하드웨어 테스트**: 듀얼 센서 동작 확인
2. ⏭️ **Python 분석**: `dual_sensor_analyzer.py` 실행
3. ⏭️ **자세 데이터 수집**: 다양한 자세로 테스트 데이터 생성
4. ⏭️ **실시간 피드백**: 알림 시스템 개발

**듀얼 센서 시스템으로 훨씬 더 정밀하고 신뢰성 있는 자세 분석이 가능합니다!** 🎯